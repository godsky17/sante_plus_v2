<html>

<head>
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
  <link rel="stylesheet" as="style" onload="this.rel='stylesheet'"
    href="https://fonts.googleapis.com/css2?display=swap&amp;family=Lexend%3Awght%40400%3B500%3B700%3B900&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900" />

  <title>Stitch Design</title>
  <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
</head>

<body>
  <div class="relative flex size-full min-h-screen flex-col bg-slate-50 group/design-root overflow-x-hidden"
    style='font-family: Lexend, "Noto Sans", sans-serif;'>
    <div class="layout-container flex h-full grow flex-col">

      <!-- HEADER -->
      <header
        class="flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#e7edf4] px-10 py-3">
        <div class="flex items-center gap-4 text-[#0d151c]">
          <div class="size-4">
            <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M36.7273 44C33.9891 44 31.6043 39.8386 30.3636 33.69C29.123 39.8386 26.7382 44 24 44C21.2618 44 18.877 39.8386 17.6364 33.69C16.3957 39.8386 14.0109 44 11.2727 44C7.25611 44 4 35.0457 4 24C4 12.9543 7.25611 4 11.2727 4C14.0109 4 16.3957 8.16144 17.6364 14.31C18.877 8.16144 21.2618 4 24 4C26.7382 4 29.123 8.16144 30.3636 14.31C31.6043 8.16144 33.9891 4 36.7273 4C40.7439 4 44 12.9543 44 24C44 35.0457 40.7439 44 36.7273 44Z"
                fill="currentColor"></path>
            </svg>
          </div>
          <h2 class="text-[#0d151c] text-lg font-bold leading-tight tracking-[-0.015em]">Sante +</h2>
        </div>
        <div class="flex flex-1 justify-end gap-8">
          <div class="flex items-center gap-9">
            <a class="text-[#0d151c] text-sm font-medium leading-normal" href="../../index.html">Accueil</a>
            <a class="text-[#0d151c] text-sm font-medium leading-normal" href="../../index.html#about">A propos</a>
            <a class="text-[#0d151c] text-sm font-medium leading-normal" href="../../index.html#contact">Contact</a>
          </div>
          <div class="flex gap-2">
            <a href="../search-medecin.html"
              class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 bg-[#e7edf4] text-[#0d151c] text-sm font-bold leading-normal tracking-[0.015em]">
              <span class="truncate">Consulter</span>
            </a>
          </div>
          <button
            class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 bg-[#e7eef3] text-[#0d151b] gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5">
            <div class="text-[#0d151b]" data-icon="Bell" data-size="20px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="currentColor"
                viewBox="0 0 256 256">
                <path
                  d="M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216ZM48,184c7.7-13.24,16-43.92,16-80a64,64,0,1,1,128,0c0,36.05,8.28,66.73,16,80Z">
                </path>
              </svg>
            </div>
          </button>
          <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10"
            style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuAjfLThLEet8QTpdwjRdsv-f_FjpLVo1UmC0A4Sd2dpLyWVZu22lxcoLSfgywgwHwJIFgp6f8HY4zKR5YYJNN79H1PMO3o9cBbow2FuTvwbecbZgMzpBZ487hK63VRo1IftRXyD_UNRENdJgRuCVGJqKaJuqnzKXBDrJSF_5BM2AavDGv1gyfExGHLQsqG2d_Eyt3g1E4SB1S3NSYe4WrkwUKMsQn5hKhDc1_EBbh1NcuURLhJGQyL4WyUKui6dtFzh7SLXl1XqkpM");'>
          </div>
        </div>
      </header>

      <div class="gap-1 px-6 flex flex-1 justify-center py-5">

        <!-- SIDEBAR -->
        <div class="layout-content-container flex flex-col w-80">
          <div class="flex h-full min-h-[700px] flex-col justify-between bg-slate-50 p-4">
            <div class="flex flex-col gap-4">
              <div class="flex gap-3">
                <h1 class="text-[#0e161b] text-base font-medium leading-normal">Admin panel</h1>
              </div>
              <div class="flex flex-col gap-2">
                <a href="./dashboard.html">
                  <div class="flex items-center gap-3 px-3 py-2 rounded-lg  bg-[#e7eef3]">
                    <div class="text-[#0e161b]" data-icon="Calendar" data-size="24px" data-weight="fill">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor"
                        viewBox="0 0 256 256">
                        <path
                          d="M208,32H184V24a8,8,0,0,0-16,0v8H88V24a8,8,0,0,0-16,0v8H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM112,184a8,8,0,0,1-16,0V132.94l-4.42,2.22a8,8,0,0,1-7.16-14.32l16-8A8,8,0,0,1,112,120Zm56-8a8,8,0,0,1,0,16H136a8,8,0,0,1-6.4-12.8l28.78-38.37A8,8,0,1,0,145.07,132a8,8,0,1,1-13.85-8A24,24,0,0,1,176,136a23.76,23.76,0,0,1-4.84,14.45L152,176ZM48,80V48H72v8a8,8,0,0,0,16,0V48h80v8a8,8,0,0,0,16,0V48h24V80Z">
                        </path>
                      </svg>
                    </div>
                    <p class="text-[#0e161b] text-sm font-medium leading-normal">Planning</p>
                  </div>
                </a>
                <a href="./dossier-medical.html">
                  <div class="flex items-center gap-3 px-3 py-2 rounded-lg">
                    <div class="text-[#0e161b]" data-icon="Calendar" data-size="24px" data-weight="fill">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor"
                        viewBox="0 0 256 256">
                        <path
                          d="M208,32H184V24a8,8,0,0,0-16,0v8H88V24a8,8,0,0,0-16,0v8H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM112,184a8,8,0,0,1-16,0V132.94l-4.42,2.22a8,8,0,0,1-7.16-14.32l16-8A8,8,0,0,1,112,120Zm56-8a8,8,0,0,1,0,16H136a8,8,0,0,1-6.4-12.8l28.78-38.37A8,8,0,1,0,145.07,132a8,8,0,1,1-13.85-8A24,24,0,0,1,176,136a23.76,23.76,0,0,1-4.84,14.45L152,176ZM48,80V48H72v8a8,8,0,0,0,16,0V48h80v8a8,8,0,0,0,16,0V48h24V80Z">
                        </path>
                      </svg>
                    </div>
                    <p class="text-[#0e161b] text-sm font-medium leading-normal">Dossier médicale</p>
                  </div>
                </a>
                <a href="./analyses.html">
                  <div class="flex items-center gap-3 px-3 py-2">
                    <div class="text-[#0e161b]" data-icon="Users" data-size="24px" data-weight="regular">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor"
                        viewBox="0 0 256 256">
                        <path
                          d="M117.25,157.92a60,60,0,1,0-66.5,0A95.83,95.83,0,0,0,3.53,195.63a8,8,0,1,0,13.4,8.74,80,80,0,0,1,134.14,0,8,8,0,0,0,13.4-8.74A95.83,95.83,0,0,0,117.25,157.92ZM40,108a44,44,0,1,1,44,44A44.05,44.05,0,0,1,40,108Zm210.14,98.7a8,8,0,0,1-11.07-2.33A79.83,79.83,0,0,0,172,168a8,8,0,0,1,0-16,44,44,0,1,0-16.34-84.87,8,8,0,1,1-5.94-14.85,60,60,0,0,1,55.53,105.64,95.83,95.83,0,0,1,47.22,37.71A8,8,0,0,1,250.14,206.7Z">
                        </path>
                      </svg>
                    </div>
                    <p class="text-[#0e161b] text-sm font-medium leading-normal">Analyses</p>
                  </div>
                </a>
                <a href="./ordonnances.html">
                  <div class="flex items-center gap-3 px-3 py-2">
                    <div class="text-[#0e161b]" data-icon="File" data-size="24px" data-weight="regular">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor"
                        viewBox="0 0 256 256">
                        <path
                          d="M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,216H56V40h88V88a8,8,0,0,0,8,8h48V216Z">
                        </path>
                      </svg>
                    </div>
                    <p class="text-[#0e161b] text-sm font-medium leading-normal">Ordonnances</p>
                  </div>
                </a>
                <a href="./historique.html">
                  <div class="flex items-center gap-3 px-3 py-2">
                    <div class="text-[#0e161b]" data-icon="File" data-size="24px" data-weight="regular">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor"
                        viewBox="0 0 256 256">
                        <path
                          d="M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,216H56V40h88V88a8,8,0,0,0,8,8h48V216Z">
                        </path>
                      </svg>
                    </div>
                    <p class="text-[#0e161b] text-sm font-medium leading-normal">Historiques</p>
                  </div>
                </a>
                <a href="./profile.html">
                  <div class="flex items-center gap-3 px-3 py-2">
                    <div class="text-[#0e161b]" data-icon="User" data-size="24px" data-weight="regular">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor"
                        viewBox="0 0 256 256">
                        <path
                          d="M230.92,212c-15.23-26.33-38.7-45.21-66.09-54.16a72,72,0,1,0-73.66,0C63.78,166.78,40.31,185.66,25.08,212a8,8,0,1,0,13.85,8c18.84-32.56,52.14-52,89.07-52s70.23,19.44,89.07,52a8,8,0,1,0,13.85-8ZM72,96a56,56,0,1,1,56,56A56.06,56.06,0,0,1,72,96Z">
                        </path>
                      </svg>
                    </div>
                    <p class="text-[#0e161b] text-sm font-medium leading-normal">Mon profil</p>
                  </div>
                </a>
              </div>
            </div>
          </div>
        </div>

        <!-- CONTAINER -->
        <!-- DASHBOARD PATIENT -->
        <div class="layout-content-container flex flex-col max-w-[960px] flex-1">
          <div class="flex flex-wrap justify-between gap-3 p-4">
            <p class="text-[#0e161b] tracking-light text-[32px] font-bold leading-tight min-w-72">Tableau de bord</p>
          </div>

          <h2 class="text-[#0e161b] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pt-5">Mes rendez-vous
          </h2>

          <!-- Filtres -->
          <div class="flex gap-2 px-4 pb-3">
            <button onclick="filtrerRendezVous('jour')"
              class="px-3 py-1.5 rounded-full bg-[#e7eef3] text-[#0e161b] text-sm font-medium hover:bg-[#d0dee7]">
              Aujourd’hui
            </button>
            <button onclick="filtrerRendezVous('semaine')"
              class="px-3 py-1.5 rounded-full bg-[#e7eef3] text-[#0e161b] text-sm font-medium hover:bg-[#d0dee7]">
              Cette semaine
            </button>
            <button onclick="filtrerRendezVous('mois')"
              class="px-3 py-1.5 rounded-full bg-[#e7eef3] text-[#0e161b] text-sm font-medium hover:bg-[#d0dee7]">
              Ce mois
            </button>
          </div>

          <div id="messageAucunRdv" class="px-4 py-3 text-center text-gray-500 hidden">
  Vous n'avez aucun rendez-vous prévu.
</div>

<!-- Le tableau existe déjà, on va juste vider et remplir son tbody -->
<table class="flex-1" id="table-rdv">
  <thead>
    <tr class="bg-slate-50">
      <th class="px-4 py-3 text-left text-[#0e161b] w-[400px] text-sm font-medium">Date</th>
      <th class="px-4 py-3 text-left text-[#0e161b] w-[400px] text-sm font-medium">Heure</th>
      <th class="px-4 py-3 text-left text-[#0e161b] w-[400px] text-sm font-medium">Type</th>
    </tr>
  </thead>
  <tbody id="tbody-rdv">
    <!-- Les lignes seront ajoutées ici par JS -->
  </tbody>
</table>


          <!-- Notifications -->
<h2 class="text-[#0e161b] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">
  Notifications
</h2>
<div id="notification-container" class="flex items-center gap-4 bg-slate-50 px-4 min-h-[72px] py-2">
  <div class="text-[#0e161b] flex items-center justify-center rounded-lg bg-[#e7eef3] shrink-0 size-12">
    <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
      <path
        d="M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216Z">
      </path>
    </svg>
  </div>
  <div id="notification-text" class="flex flex-col justify-center">
    <!-- Le contenu sera injecté ici par le script -->
  </div>
</div>

          <!-- Historique -->
          <!-- Section Historique des consultations -->
          <h2 class="text-[#0e161b] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pt-5">
            Historique des consultations
          </h2>

          <!-- Filtres -->
          <div class="flex gap-2 px-4 pb-3">
            <button onclick="filtrerHistorique('jour')"
              class="px-3 py-1.5 rounded-full bg-[#e7eef3] text-[#0e161b] text-sm font-medium hover:bg-[#d0dee7]">
              Aujourd’hui
            </button>
            <button onclick="filtrerHistorique('semaine')"
              class="px-3 py-1.5 rounded-full bg-[#e7eef3] text-[#0e161b] text-sm font-medium hover:bg-[#d0dee7]">
              Cette semaine
            </button>
            <button onclick="filtrerHistorique('mois')"
              class="px-3 py-1.5 rounded-full bg-[#e7eef3] text-[#0e161b] text-sm font-medium hover:bg-[#d0dee7]">
              Ce mois
            </button>
          </div>

          <!-- Tableau Historique -->
          <div class="px-4 py-3">
            <div class="flex overflow-hidden rounded-lg border border-[#d0dee7] bg-slate-50">
              <table class="flex-1" id="table-historique">
                <thead>
                  <tr class="bg-slate-50">
                    <th class="px-4 py-3 text-left text-[#0e161b] w-[400px] text-sm font-medium">Date</th>
                    <th class="px-4 py-3 text-left text-[#0e161b] w-[400px] text-sm font-medium">Médecin</th>
                    <th class="px-4 py-3 text-left text-[#0e161b] w-[400px] text-sm font-medium">Type</th>
                  </tr>
                </thead>
                <tbody>
                  <tr data-date="2025-07-05" class="border-t border-t-[#d0dee7]">
                    <td class="px-4 py-2 text-[#0e161b] text-sm">2025-07-05</td>
                    <td class="px-4 py-2 text-[#4e7a97] text-sm">Dr. A. Koffi</td>
                    <td class="px-4 py-2 text-[#4e7a97] text-sm">Vidéo</td>
                  </tr>
                  <tr data-date="2025-07-02" class="border-t border-t-[#d0dee7]">
                    <td class="px-4 py-2 text-[#0e161b] text-sm">2025-07-02</td>
                    <td class="px-4 py-2 text-[#4e7a97] text-sm">Dr. M. Hounkpe</td>
                    <td class="px-4 py-2 text-[#4e7a97] text-sm">Présentiel</td>
                  </tr>
                  <tr data-date="2025-06-27" class="border-t border-t-[#d0dee7]">
                    <td class="px-4 py-2 text-[#0e161b] text-sm">2025-06-27</td>
                    <td class="px-4 py-2 text-[#4e7a97] text-sm">Dr. H. Gbèdégbé</td>
                    <td class="px-4 py-2 text-[#4e7a97] text-sm">Vidéo</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <script>
// Parse date + heure en objet Date JS complet
function parseDateHeure(dateStr, heureStr) {
  return new Date(dateStr + "T" + heureStr + ":00");
}

// Fonction pour récupérer les rendez-vous depuis une API
async function fetchRendezVousUtilisateur() {
  try {
    const response = await fetch('/api/rendezvous', {
      headers: { 'Accept': 'application/json' },
      credentials: 'include' // si authentification par session
    });
    if (!response.ok) throw new Error('Erreur réseau');
    const data = await response.json();
    return data; // [{date, heure, type}, ...]
  } catch (error) {
    console.error("Erreur récupération rdv:", error);
    return [];
  }
}

// Affiche les rendez-vous dans le tableau
async function afficherRendezVous() {
  const rdv = await fetchRendezVousUtilisateur();

  const tbody = document.getElementById("tbody-rdv");
  const message = document.getElementById("messageAucunRdv");
  const table = document.getElementById("table-rdv");

  tbody.innerHTML = "";

  if (!rdv || rdv.length === 0) {
    message.classList.remove("hidden");
    table.style.display = "none";
    return;
  }

  message.classList.add("hidden");
  table.style.display = "";

  rdv.forEach(r => {
    const tr = document.createElement("tr");
    tr.classList.add("border-t", "border-t-[#d0dee7]");
    tr.setAttribute("data-date", r.date);

    tr.innerHTML = `
      <td class="px-4 py-2 text-[#0e161b] text-sm">${r.date}</td>
      <td class="px-4 py-2 text-[#4e7a97] text-sm">${r.heure}</td>
      <td class="px-4 py-2 text-[#4e7a97] text-sm">${r.type}</td>
    `;
    tbody.appendChild(tr);
  });
}

// Filtre les rendez-vous dans le tableau selon la période choisie
function filtrerRendezVous(periode) {
  const maintenant = new Date();
  const lignes = document.querySelectorAll("#table-rdv tbody tr");

  lignes.forEach(ligne => {
    const dateStr = ligne.getAttribute("data-date");
    const heureStr = ligne.querySelector("td:nth-child(2)").textContent.trim();
    const dateRdv = parseDateHeure(dateStr, heureStr);

    let afficher = false;

    switch (periode) {
      case 'jour':
        afficher = dateRdv.toDateString() === maintenant.toDateString();
        break;

      case 'semaine': {
        // Premier jour de la semaine (dimanche)
        const debutSemaine = new Date(maintenant);
        debutSemaine.setDate(debutSemaine.getDate() - debutSemaine.getDay());
        // Dernier jour de la semaine (samedi)
        const finSemaine = new Date(debutSemaine);
        finSemaine.setDate(finSemaine.getDate() + 6);

        afficher = dateRdv >= debutSemaine && dateRdv <= finSemaine;
        break;
      }

      case 'mois':
        afficher = dateRdv.getMonth() === maintenant.getMonth() && dateRdv.getFullYear() === maintenant.getFullYear();
        break;
    }

    ligne.style.display = afficher ? "" : "none";
  });
}

// Affiche dans la zone notifications les rendez-vous dans les 48h à venir
async function afficherNotifications() {
  const notificationsContainer = document.getElementById("notification-container");
  const notificationText = document.getElementById("notification-text");

  const rdv = await fetchRendezVousUtilisateur();

  const maintenant = new Date();
  const limite = new Date(maintenant.getTime() + 48 * 60 * 60 * 1000); // +48h

  // Filtrer les rdv dans les 48h à venir
  const rdvImminents = rdv.filter(r => {
    const dateRdv = parseDateHeure(r.date, r.heure);
    return dateRdv >= maintenant && dateRdv <= limite;
  });

  // Nettoyer l'affichage actuel
  notificationText.innerHTML = "";

  if (rdvImminents.length === 0) {
    notificationText.innerHTML = `<p class="text-[#0e161b] text-base font-medium leading-normal line-clamp-1">Aucune consultation imminente.</p>`;
    return;
  }

  // Afficher la liste des notifications pour les rendez-vous imminents
  rdvImminents.forEach(r => {
    // Formatage de la date/heure pour affichage (exemple "5 juil. à 10:00")
    const dateRdv = new Date(r.date);
    const optionsDate = { day: 'numeric', month: 'short' };
    const dateFormat = dateRdv.toLocaleDateString('fr-FR', optionsDate);

    const notifDiv = document.createElement("div");
    notifDiv.classList.add("flex", "items-center", "gap-4", "bg-slate-50", "px-4", "min-h-[72px]", "py-2", "border-b", "border-gray-200");

    notifDiv.innerHTML = `
      <div class="text-[#0e161b] flex items-center justify-center rounded-lg bg-[#e7eef3] shrink-0 size-12">
        <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
          <path d="M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216Z"></path>
        </svg>
      </div>
      <div class="flex flex-col justify-center">
        <p class="text-[#0e161b] text-base font-medium leading-normal line-clamp-1">Rappel : ${r.type} à ${r.heure}</p>
        <p class="text-[#4e7a97] text-sm font-normal leading-normal line-clamp-2">${dateFormat}</p>
      </div>
    `;

    notificationText.appendChild(notifDiv);
  });
}

// Au chargement : afficher les rendez-vous et notifications
window.addEventListener("DOMContentLoaded", () => {
  afficherRendezVous();
  afficherNotifications();
});

async function fetchHistoriqueConsultations() {
  try {
    const response = await fetch('/api/consultations', {
      headers: {
        'Accept': 'application/json',
        // Ajoute ton token ici si nécessaire :
        // 'Authorization': 'Bearer TON_TOKEN',
      },
      credentials: 'include'
    });

    if (!response.ok) throw new Error('Erreur lors de la récupération des consultations');
    const data = await response.json();
    return data; // Doit être un tableau d’objets : [{ date, medecin, type }]
  } catch (error) {
    console.error("Erreur fetch historique consultations :", error);
    return [];
  }
}

async function afficherHistoriqueConsultations() {
  const consultations = await fetchHistoriqueConsultations();

  const tbody = document.querySelector("#table-historique tbody");

  // Réinitialise le tableau
  tbody.innerHTML = "";

  // On garde max 5 consultations récentes (triées par date décroissante)
  const consultationsTriees = consultations
    .sort((a, b) => new Date(b.date) - new Date(a.date))
    .slice(0, 5);

  consultationsTriees.forEach(consult => {
    const tr = document.createElement("tr");
    tr.classList.add("border-t", "border-t-[#d0dee7]");
    tr.setAttribute("data-date", consult.date);

    tr.innerHTML = `
      <td class="px-4 py-2 text-[#0e161b] text-sm">${consult.date}</td>
      <td class="px-4 py-2 text-[#4e7a97] text-sm">${consult.medecin}</td>
      <td class="px-4 py-2 text-[#4e7a97] text-sm">${consult.type}</td>
    `;

    tbody.appendChild(tr);
  });

  // Si aucune consultation, affiche un message
  if (consultationsTriees.length === 0) {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td colspan="3" class="px-4 py-2 text-center text-gray-500 text-sm">
        Aucune consultation trouvée.
      </td>
    `;
    tbody.appendChild(tr);
  }
}

// Appel au chargement
window.addEventListener("DOMContentLoaded", afficherHistoriqueConsultations);

</script>
</body>

</html>